<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Elixir/Dark Elixir Calculator</title>
<script>
document.addEventListener("DOMContentLoaded", () => {
  const navToggle = document.querySelector(".nav-toggle");
  const navContainer = document.querySelector(".nav-container");

  if (navToggle) {
    navToggle.addEventListener("click", () => {
      navContainer.classList.toggle("active");
    });
  }
});
</script>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #0d1117;
      color: #e6edf3;
      margin: 0;
      padding: 20px;
    }
    .calculator {
      background: #161b22;
      padding: 20px;
      border-radius: 12px;
      max-width: 700px;
      margin: auto;
      box-shadow: 0 0 10px rgba(0,0,0,0.5);
    }
    h2 {
      margin-bottom: 15px;
      color: #58a6ff;
    }
    label {
      display: block;
      margin-top: 10px;
    }
    input, select {
  width: 100%;
  padding: 10px;
  margin-top: 5px;
  border-radius: 6px;
  border: 1px solid #30363d;
  background: #161b22;
  color: #e6edf3;
  box-sizing: border-box;
  transition: border-color 0.2s ease, box-shadow 0.2s ease;
}

input:focus, select:focus {
  outline: none;
  border-color: #58a6ff;
  box-shadow: 0 0 5px rgba(88, 166, 255, 0.5);
}
    .results {
      margin-top: 20px;
      background: #0d1117;
      padding: 15px;
      border-radius: 10px;
      white-space: pre-line;
    }
    .separator {
      border-top: 1px solid #30363d;
      margin: 10px 0;
    }
    .copy-btn {
      margin-top: 10px;
      background: #484f58;
    }
    .nav-container {
    max-width: 950px; /* same as .container */
    margin: 0 auto 20px auto;
    background: #161b22;
    border-radius: 12px;
    box-shadow: 0 4px 30px rgba(0,0,0,0.5);
    overflow: hidden;
    margin-top: 0px;
  }
  .nav-toggle {
    width: 100%;
    padding: 14px;
    background: #21262d;
    border: none;
    color: #e6edf3;
    font-size: 1.1em;
    cursor: pointer;
    text-align: left;
    transition: background 0.3s ease;
  }
  .nav-toggle:hover {
    background: #2d333b;
  }
  .nav-menu {
    max-height: 0;
    overflow: hidden;
    display: flex;
    flex-direction: column;
    transition: max-height 0.4s ease;
  }
  .nav-menu a {
    padding: 12px 16px;
    text-decoration: none;
    color: #e6edf3;
    transition: background 0.2s ease;
  }
  .nav-menu a:hover {
    background: #238636;
    color: #fff;
  }
  .nav-container.active .nav-menu {
    max-height: 200px; /* enough for 2‚Äì3 links */
  }
.btn {
      background: #238636;
      color: white;
      padding: 12px 24px;
      border: none;
      border-radius: 12px;
      cursor: pointer;
      font-size: 1em;
      transition: background 0.2s;
      margin-top: 10px;
    }
    .btn:hover:not(:disabled) {
      background: #2ea043;
    }
    .btn:disabled {
      background: #30363d;
      cursor: not-allowed;
    }
  </style>
    <script>
  // Cache-busting only for deployed environment (not local testing)
  function bustCache() {
    const isLocal = location.hostname === "localhost" || location.protocol === "file:";

    if (isLocal) return; // skip cache-busting locally

    const timestamp = new Date().getTime();

    // Bust local CSS
    document.querySelectorAll("link[rel='stylesheet']").forEach(link => {
      if (!link.href.startsWith("http")) { // only local files
        link.href = link.href.split("?")[0] + "?v=" + timestamp;
      }
    });

    // Bust local JS
    document.querySelectorAll("script[src]").forEach(script => {
      if (!script.src.startsWith("http")) { // only local files
        const src = script.src.split("?")[0];
        script.src = src + "?v=" + timestamp;
      }
    });
  }

  bustCache();
  </script>
</head>
<body>
<!-- Navigation Menu -->
<div class="nav-container">
  <button class="nav-toggle">‚ò∞ Menu</button>
  <nav class="nav-menu">
    <a href="index.html">üè† Home</a>
    <a href="elixir-calculator.html">‚öîÔ∏è Elixir/Dark Elixir</a>
  </nav>
</div>
  <div class="calculator">
    <h2>‚öîÔ∏è Elixir/Dark Elixir Calculator</h2>
    <label>‚≠ê Current Level:
  <input type="number" id="currentLevel" value="0" min="0">
</label>
    <label>üè∞ Clan Castle Level:
      <select id="ccLevel" onchange="updateConstraints()">
        <option value="1">1</option>
        <option value="2">2</option>
        <option value="3">3</option>
        <option value="4">4</option>
        <option value="5">5</option>
        <option value="6">6</option>
        <option value="7">7</option>
        <option value="8">8</option>
        <option value="9">9</option>
        <option value="10">10</option>
        <option value="11">11</option>
        <option value="12">12</option>
        <option value="13">13</option>
      </select>
    </label>
    <label>üë• Total Accounts:
      <input type="number" id="accounts" value="1" min="1">
    </label>
    <label>üîÅ Iterations per Day:
      <input type="number" id="iterations" value="1" min="1">
    </label>
    <label>üìÖ Number of Days:
      <input type="number" id="days" value="1" min="1">
    </label>

    <div id="troopInputs">
      <label>‚öîÔ∏è Elixir Troops (spaces): <input type="number" id="elixirTroops" value="0" min="0"></label>
      <label>üåë Dark Troops (spaces): <input type="number" id="darkTroops" value="0" min="0"></label>
      <label>üß™ Elixir Spells (spaces): <input type="number" id="elixirSpells" value="0" min="0"></label>
      <label>‚ò†Ô∏è Dark Spells (spaces): <input type="number" id="darkSpells" value="0" min="0"></label>
      <label>üõ°Ô∏è Siege Machines: <input type="number" id="siege" value="0" min="0"></label>
    </div>

  <button class="btn" onclick="calculateCosts()">Calculate</button>
  <button class="btn" onclick="copyResults()">Copy Results</button>

    <div id="results" class="results"></div>

  </div>

<script>
  const ccData = {
    1:{troops:10,spells:0,siege:0},
    2:{troops:15,spells:0,siege:0},
    3:{troops:20,spells:0,siege:0},
    4:{troops:25,spells:1,siege:0},
    5:{troops:30,spells:1,siege:0},
    6:{troops:35,spells:1,siege:1},
    7:{troops:35,spells:2,siege:1},
    8:{troops:40,spells:2,siege:1},
    9:{troops:45,spells:2,siege:1},
    10:{troops:45,spells:3,siege:1},
    11:{troops:50,spells:3,siege:1},
    12:{troops:50,spells:3,siege:2},
    13:{troops:55,spells:3,siege:2}
  };

  function xpForNextLevel(level) {
    // example curve: adjust this to your real formula
    return 1000 + (level * 100);
  }

  function xpToLevel(currentLevel, gainedXP) {
    let totalXP = gainedXP; 
    let level = currentLevel;

    while (totalXP >= xpForNextLevel(level)) {
      totalXP -= xpForNextLevel(level);
      level++;
    }

    return {
      level: level,
      leftoverXP: totalXP
    };
  }

  function updateConstraints() {
    const level = parseInt(document.getElementById("ccLevel").value);
    const {troops,spells,siege} = ccData[level];
    document.getElementById("elixirTroops").max = troops;
    document.getElementById("darkTroops").max = troops;
    document.getElementById("elixirSpells").max = spells;
    document.getElementById("darkSpells").max = spells;
    document.getElementById("siege").max = siege;

    // defaults: max elixir, 0 dark
    document.getElementById("elixirTroops").value = troops;
    document.getElementById("darkTroops").value = 0;
    document.getElementById("elixirSpells").value = spells;
    document.getElementById("darkSpells").value = 0;
    document.getElementById("siege").value = siege;
  }

  function calculateCosts() {
    const currentLevel = parseInt(document.getElementById("currentLevel").value)||0;
    const level = parseInt(document.getElementById("ccLevel").value);
    const accounts = parseInt(document.getElementById("accounts").value)||1;
    const iterations = parseInt(document.getElementById("iterations").value)||1;
    const days = parseInt(document.getElementById("days").value)||1;

    const elixirTroops = parseInt(document.getElementById("elixirTroops").value)||0;
    const darkTroops = parseInt(document.getElementById("darkTroops").value)||0;
    const elixirSpells = parseInt(document.getElementById("elixirSpells").value)||0;
    const darkSpells = parseInt(document.getElementById("darkSpells").value)||0;
    const siege = parseInt(document.getElementById("siege").value)||0;

    const max = ccData[level];
    if (elixirTroops + darkTroops > max.troops) {alert("Troops exceed limit!"); return;}
    if (elixirSpells + darkSpells > max.spells) {alert("Spells exceed limit!"); return;}

    const elixirCostDonation = (Math.ceil(elixirTroops/2)*3000) + (elixirSpells*9000) + (siege*45000);
    const darkCostDonation = (Math.ceil(darkTroops/2)*45) + (darkSpells*135);

    const xpDonation = elixirTroops*1 + darkTroops*1 + elixirSpells*5 + darkSpells*5 + siege*30;

    const iterationMultiplier = accounts;
    const dayMultiplier = accounts*iterations;
    const daysMultiplier = accounts*iterations*days;

    const single = xpToLevel(currentLevel, xpDonation);
    const iteration = xpToLevel(currentLevel, xpDonation*iterationMultiplier);
    const daily = xpToLevel(currentLevel, xpDonation*dayMultiplier);
    const total = xpToLevel(currentLevel, xpDonation*daysMultiplier);

    let out = `üì• User Input:
‚≠ê Current Level: ${currentLevel}
üè∞ Clan Castle Level: ${level}
üë• Total Accounts: ${accounts}
üîÅ Iterations per Day: ${iterations}
üìÖ Days: ${days}
‚öîÔ∏è Elixir Troops: ${elixirTroops}, üåë Dark Troops: ${darkTroops}, üß™ Elixir Spells: ${elixirSpells}, ‚ò†Ô∏è Dark Spells: ${darkSpells}, üõ°Ô∏è Siege: ${siege}

üìä Results:
-- In one donation (1 account) --
‚ö° Elixir: ${elixirCostDonation.toLocaleString()}
üåë Dark Elixir: ${darkCostDonation.toLocaleString()}
‚≠ê XP: ${xpDonation.toLocaleString()}
üìà Level Reached: ${single.level}
üí† Leftover XP: ${single.leftoverXP.toLocaleString()}

‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
-- In one iteration (all accounts) --
‚ö° Elixir: ${(elixirCostDonation*iterationMultiplier).toLocaleString()}
üåë Dark Elixir: ${(darkCostDonation*iterationMultiplier).toLocaleString()}
‚≠ê XP: ${(xpDonation*iterationMultiplier).toLocaleString()}
üìà Level Reached: ${iteration.level}
üí† Leftover XP: ${iteration.leftoverXP.toLocaleString()}

‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
-- In one day --
‚ö° Elixir: ${(elixirCostDonation*dayMultiplier).toLocaleString()}
üåë Dark Elixir: ${(darkCostDonation*dayMultiplier).toLocaleString()}
‚≠ê XP: ${(xpDonation*dayMultiplier).toLocaleString()}
üìà Level Reached: ${daily.level}
üí† Leftover XP: ${daily.leftoverXP.toLocaleString()}

‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
-- In ${days} days --
‚ö° Elixir: ${(elixirCostDonation*daysMultiplier).toLocaleString()}
üåë Dark Elixir: ${(darkCostDonation*daysMultiplier).toLocaleString()}
‚≠ê XP: ${(xpDonation*daysMultiplier).toLocaleString()}
üìà Level Reached: ${total.level}
üí† Leftover XP: ${total.leftoverXP.toLocaleString()}
`;

    document.getElementById("results").textContent = out;
  }

  function copyResults() {
    const results = document.getElementById("results").textContent;
    navigator.clipboard.writeText(results).then(()=>alert("Results copied!"));
  }

  // initialize defaults when page loads
  updateConstraints();
</script>

</body>
</html>
